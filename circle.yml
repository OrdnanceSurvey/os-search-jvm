machine:
   java:
      version: oraclejdk8
   post:
      - echo $PGP_KEY | base64 --decode > ~/sec_key.gpg
      - gpg --import --allow-secret-key-import ~/sec_key.gpg
      - rm ~/sec_key.gpg
      - mkdir -p ~/.gradle
      - echo 'signing.keyId=FB77CA6B' > ~/.gradle/gradle.properties

general:
  artifacts:
    - "search-java/build/reports" # relative to the build directory

test:
   override:
      - ./gradlew clean test
   post:
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/
    - cp -R search-java/build/test-results/* $CIRCLE_ARTIFACTS

notify:

deployment:
  master:
    branch: master 
    commands:
      - ./gradlew clean test uploadArchives

